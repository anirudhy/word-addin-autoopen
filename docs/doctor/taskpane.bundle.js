(()=>{let e,t,n,o,i,c,s,a;function r(e,t="info"){const o=`[${(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3})}] ${e}`;if(console.log(`[project1] [${t.toUpperCase()}] ${o}`),n){const e=document.createElement("div");e.className=`log-entry ${t}`,e.textContent=o,n.appendChild(e),n.scrollTop=n.scrollHeight}}function u(n){e.className=`status ${n}`;const o={connected:"Connected to WebSocket",connecting:"Connecting...",disconnected:"Disconnected",disabled:"WebSocket Disabled (Testing Mode)"};t.textContent=o[n]||n,r(`[WS STATUS] ${o[n]||n}`,"info")}function d(){r("[WS] WebSocket connection disabled (not available from office.com)","info"),r("[WS] Auto-open feature works without WebSocket!","info"),u("disabled")}function f(){r("[AUTO-OPEN] Enable button clicked","sent"),r("[AUTO-OPEN] Reading current setting value...","info"),r(`[AUTO-OPEN] Current value: ${Office.context.document.settings.get("Office.AutoShowTaskpaneWithDocument")}`,"info"),r("[AUTO-OPEN] Setting Office.AutoShowTaskpaneWithDocument = true","info"),Office.context.document.settings.set("Office.AutoShowTaskpaneWithDocument",!0),r("[AUTO-OPEN] Calling settings.saveAsync()...","info"),Office.context.document.settings.saveAsync(e=>{r("[AUTO-OPEN] saveAsync callback triggered","info"),r(`[AUTO-OPEN] Result status: ${e.status}`,"info"),e.status===Office.AsyncResultStatus.Succeeded?(r("[AUTO-OPEN] ✓ Setting SAVED successfully to document","received"),r("[AUTO-OPEN] Task pane will auto-open on next document load","received"),r(`[AUTO-OPEN] Verification read: ${Office.context.document.settings.get("Office.AutoShowTaskpaneWithDocument")}`,"info"),l(!0)):(r(`[AUTO-OPEN] ✗ FAILED to save: ${e.error.message}`,"error"),r(`[AUTO-OPEN] Error code: ${e.error.code}`,"error"),r(`[AUTO-OPEN] Error name: ${e.error.name}`,"error"))})}function O(){r("[AUTO-OPEN] Disable button clicked","sent"),r("[AUTO-OPEN] Reading current setting value...","info"),r(`[AUTO-OPEN] Current value: ${Office.context.document.settings.get("Office.AutoShowTaskpaneWithDocument")}`,"info"),r("[AUTO-OPEN] Setting Office.AutoShowTaskpaneWithDocument = false","info"),Office.context.document.settings.set("Office.AutoShowTaskpaneWithDocument",!1),r("[AUTO-OPEN] Calling settings.saveAsync()...","info"),Office.context.document.settings.saveAsync(e=>{r("[AUTO-OPEN] saveAsync callback triggered","info"),r(`[AUTO-OPEN] Result status: ${e.status}`,"info"),e.status===Office.AsyncResultStatus.Succeeded?(r("[AUTO-OPEN] ✓ Setting SAVED successfully to document","received"),r("[AUTO-OPEN] Task pane will NOT auto-open on next document load","received"),r(`[AUTO-OPEN] Verification read: ${Office.context.document.settings.get("Office.AutoShowTaskpaneWithDocument")}`,"info"),l(!1)):(r(`[AUTO-OPEN] ✗ FAILED to save: ${e.error.message}`,"error"),r(`[AUTO-OPEN] Error code: ${e.error.code}`,"error"),r(`[AUTO-OPEN] Error name: ${e.error.name}`,"error"))})}function l(e){r("[AUTO-OPEN] Updating UI status indicator to: "+(e?"ENABLED":"DISABLED"),"info"),c.textContent="Auto-Open: "+(e?"Enabled":"Disabled"),c.className="autoopen-status "+(e?"enabled":"disabled")}Office.onReady(A=>{console.log("[project1] [INIT] Office.onReady called",A),e=document.getElementById("wsStatus"),t=document.getElementById("wsStatusText"),n=document.getElementById("log"),o=document.getElementById("enableAutoOpen"),i=document.getElementById("disableAutoOpen"),c=document.getElementById("autoOpenStatus"),s=document.getElementById("reconnectBtn"),a=document.getElementById("clearLog"),r("=== OFFICE ADD-IN STARTING ===","info"),r(`Host: ${A.host}`,"info"),r(`Platform: ${A.platform}`,"info"),A.host===Office.HostType.Word?(r("✓ Running in Word (expected host)","info"),o.addEventListener("click",f),i.addEventListener("click",O),s.addEventListener("click",d),a.addEventListener("click",()=>{r("--- Log cleared by user ---","info"),n.innerHTML=""}),r("Event listeners attached","info"),r("Checking initial auto-open status...","info"),function(){r("[AUTO-OPEN] Checking current auto-open status...","info");try{const e=Office.context.document.settings.get("Office.AutoShowTaskpaneWithDocument");r(`[AUTO-OPEN] Retrieved setting value: ${e}`,"info"),r("[AUTO-OPEN] Type: "+typeof e,"info");const t=!0===e;r("[AUTO-OPEN] Interpreted as: "+(t?"ENABLED":"DISABLED"),"info"),l(t)}catch(e){r(`[AUTO-OPEN] ✗ Error checking status: ${e.message}`,"error"),l(!1)}}(),r("⚠️ WebSocket disabled for testing (browser security restrictions)","info"),r("✓ Auto-open feature will still work perfectly!","info"),u("disabled"),r("=== INITIALIZATION COMPLETE ===","info")):r(`✗ Unexpected host: ${A.host} (expected Word)`,"error")})})();